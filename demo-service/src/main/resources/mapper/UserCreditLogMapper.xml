<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.mapper.UserCreditLogMapper">

    <resultMap id="UserCreditLogResultMap" type="com.demo.entity.UserCreditLog">
        <id property="id" column="id"/>
        <result property="userId" column="user_id"/>
        <result property="delta" column="delta"/>
        <result property="reasonType" column="reason_type"/>
        <result property="reasonNote" column="reason_note"/>
        <result property="refId" column="ref_id"/>
        <result property="scoreBefore" column="score_before"/>
        <result property="scoreAfter" column="score_after"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <insert id="insert" parameterType="com.demo.entity.UserCreditLog" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO user_credit_logs (user_id, delta, reason_type, reason_note, ref_id, score_before, score_after, create_time)
        VALUES (#{userId}, #{delta}, #{reasonType}, #{reasonNote}, #{refId}, #{scoreBefore}, #{scoreAfter}, NOW())
    </insert>

    <select id="listByUserId" resultMap="UserCreditLogResultMap">
        SELECT id, user_id, delta, reason_type, reason_note, ref_id, score_before, score_after, create_time
        FROM user_credit_logs
        WHERE user_id = #{userId}
        ORDER BY create_time DESC
    </select>

</mapper>
